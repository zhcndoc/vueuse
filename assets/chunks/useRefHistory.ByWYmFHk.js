import{i as e}from"./filters.FeueHqze.js";import{t}from"./watchIgnorable.BPNcCjE1.js";import{t as n}from"./useManualRefHistory.1siV1ND1.js";function r(r,i={}){let{deep:a=!1,flush:o=`pre`,eventFilter:s,shouldCommit:c=()=>!0}=i,{eventFilter:l,pause:u,resume:d,isActive:f}=e(s),p=r.value,{ignoreUpdates:m,ignorePrevAsyncUpdates:h,stop:g}=t(r,x,{deep:a,flush:o,eventFilter:l});function _(e,t){h(),m(()=>{e.value=t,p=t})}let v=n(r,{...i,clone:i.clone||a,setSource:_}),{clear:y,commit:b}=v;function x(){h(),c(p,r.value)&&(p=r.value,b())}function S(e){d(),e&&x()}function C(e){let t=!1,n=()=>t=!0;m(()=>{e(n)}),t||x()}function w(){g(),y()}return{...v,isTracking:f,pause:u,resume:S,commit:x,batch:C,dispose:w}}export{r as t};