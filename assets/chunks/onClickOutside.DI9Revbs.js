import{Ct as e}from"./vue.CAJL2k56.js";import{a as t,s as n}from"./is.CbRwWVeh.js";import{t as r}from"./useEventListener.c80kvxRv.js";import{r as i}from"./configurable.CHIFr4yg.js";import{t as a}from"./unrefElement.BXTXpAEN.js";var o=!1;function s(s,c,l={}){let{window:u=i,ignore:d=[],capture:f=!0,detectIframe:p=!1,controls:m=!1}=l;if(!u)return m?{stop:n,cancel:n,trigger:n}:n;if(t&&!o){o=!0;let e={passive:!0};Array.from(u.document.body.children).forEach(t=>t.addEventListener(`click`,n,e)),u.document.documentElement.addEventListener(`click`,n,e)}let h=!0,g=t=>e(d).some(e=>{if(typeof e==`string`)return Array.from(u.document.querySelectorAll(e)).some(e=>e===t.target||t.composedPath().includes(e));{let n=a(e);return n&&(t.target===n||t.composedPath().includes(n))}});function _(t){let n=e(t);return n&&n.$.subTree.shapeFlag===16}function v(t,n){let r=e(t),i=r.$.subTree&&r.$.subTree.children;return i==null||!Array.isArray(i)?!1:i.some(e=>e.el===n.target||n.composedPath().includes(e.el))}let y=e=>{let t=a(s);if(e.target!=null&&!(!(t instanceof Element)&&_(s)&&v(s,e))&&!(!t||t===e.target||e.composedPath().includes(t))){if(`detail`in e&&e.detail===0&&(h=!g(e)),!h){h=!0;return}c(e)}},b=!1,x=[r(u,`click`,e=>{b||(b=!0,setTimeout(()=>{b=!1},0),y(e))},{passive:!0,capture:f}),r(u,`pointerdown`,e=>{let t=a(s);h=!g(e)&&!!(t&&!e.composedPath().includes(t))},{passive:!0}),p&&r(u,`blur`,e=>{setTimeout(()=>{let t=a(s);u.document.activeElement?.tagName===`IFRAME`&&!t?.contains(u.document.activeElement)&&c(e)},0)},{passive:!0})].filter(Boolean),S=()=>x.forEach(e=>e());return m?{stop:S,cancel:()=>{h=!1},trigger:e=>{h=!0,y(e),h=!1}}:S}export{s as t};