import{P as e,Q as t,tS as n,th as r,tv as i,v as a}from"./vue.DLm9j74-.js";import{t as o}from"./tryOnMounted.CJs_r5qD.js";import{t as s}from"./watchPausable.C0q9cU2I.js";import{t as c}from"./useEventListener.Cti38iiT.js";import{r as l}from"./configurable.DuBTHq8T.js";var u=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},d=`__vueuse_ssr_handlers__`,f=p();function p(){return`__vueuse_ssr_handlers__`in u||(u[d]=u.__vueuse_ssr_handlers__||{}),u[d]}function m(e,t){return f[e]||t}function h(e){return e==null?`any`:e instanceof Set?`set`:e instanceof Map?`map`:e instanceof Date?`date`:typeof e==`boolean`?`boolean`:typeof e==`string`?`string`:typeof e==`object`?`object`:Number.isNaN(e)?`any`:`number`}const g={boolean:{read:e=>e===`true`,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},_=`vueuse-storage`;function v(u,d,f,p={}){let{flush:v=`pre`,deep:y=!0,listenToStorageChanges:b=!0,writeDefaults:x=!0,mergeDefaults:S=!1,shallow:C,window:w=l,eventFilter:T,onError:E=e=>{console.error(e)},initOnMounted:D}=p,O=(C?i:r)(typeof d==`function`?d():d),k=a(()=>n(u));if(!f)try{f=m(`getDefaultStorage`,()=>l?.localStorage)()}catch(e){E(e)}if(!f)return O;let A=n(d),j=h(A),M=p.serializer??g[j],{pause:N,resume:P}=s(O,e=>L(e),{flush:v,deep:y,eventFilter:T});t(k,()=>z(),{flush:v});let F=!1;w&&b&&(f instanceof Storage?c(w,`storage`,e=>{D&&!F||z(e)},{passive:!0}):c(w,_,e=>{D&&!F||B(e)})),D?o(()=>{F=!0,z()}):z();function I(e,t){if(w){let n={key:k.value,oldValue:e,newValue:t,storageArea:f};w.dispatchEvent(f instanceof Storage?new StorageEvent(`storage`,n):new CustomEvent(_,{detail:n}))}}function L(e){try{let t=f.getItem(k.value);if(e==null)I(t,null),f.removeItem(k.value);else{let n=M.write(e);t!==n&&(f.setItem(k.value,n),I(t,n))}}catch(e){E(e)}}function R(e){let t=e?e.newValue:f.getItem(k.value);if(t==null)return x&&A!=null&&f.setItem(k.value,M.write(A)),A;if(!e&&S){let e=M.read(t);return typeof S==`function`?S(e,A):j===`object`&&!Array.isArray(e)?{...A,...e}:e}else if(typeof t!=`string`)return t;else return M.read(t)}function z(t){if(!(t&&t.storageArea!==f)){if(t&&t.key==null){O.value=A;return}if(!(t&&t.key!==k.value)){N();try{let e=M.write(O.value);(t===void 0||t?.newValue!==e)&&(O.value=R(t))}catch(e){E(e)}finally{t?e(P):P()}}}}function B(e){z(e.detail)}return O}export{m as n,v as t};